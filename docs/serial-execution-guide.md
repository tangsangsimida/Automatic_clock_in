# 串行执行模式说明

## 概述

为了解决多账号同时提交时产生未合并PR和合并冲突的问题，系统已升级为串行执行模式。现在多个账号会依次进行提交和合并，确保每个账号完成完整的提交-合并流程后再处理下一个账号。

## 主要改进

### 1. 串行执行机制
- **之前**: 多个账号并发提交，容易产生合并冲突
- **现在**: 账号依次执行，每个账号完成提交并合并后再处理下一个

### 2. 完整的提交-合并流程
每个账号的处理流程：
1. 创建提交
2. 创建分支
3. 创建Pull Request
4. **自动合并PR**（如果启用auto_merge）
5. **删除分支**（如果启用delete_branch_after_merge）
6. 等待指定时间后处理下一个账号

### 3. 智能延迟机制
- **基础延迟**: 30秒（可配置）
- **递增延迟**: 每个后续账号额外增加15秒（可配置）
- **冲突重试**: 检测到冲突时智能重试

## 配置说明

### 串行执行配置
```json
{
  "serial_execution_delay": 30,        // 账号间基础延迟（秒）
  "serial_execution_increment": 15,    // 每个账号的额外延迟（秒）
  "max_workers": 1                     // 确保串行执行
}
```

### 账号配置
```json
{
  "name": "account1",
  "auto_merge": true,                  // 启用自动合并
  "delete_branch_after_merge": true   // 合并后删除分支
}
```

## 执行时序示例

假设有3个账号（A、B、C），执行时序如下：

```
时间轴:
0s    - 开始处理账号A
30s   - 账号A完成，开始处理账号B（延迟30s）
75s   - 账号B完成，开始处理账号C（延迟30+15=45s）
135s  - 账号C完成，所有账号处理完毕
```

## 优势

1. **避免合并冲突**: 串行执行确保不会有多个PR同时尝试合并
2. **完整流程**: 每个账号都完成提交-合并的完整流程
3. **智能重试**: 检测冲突类型并智能重试
4. **可配置延迟**: 可根据需要调整账号间的延迟时间
5. **详细日志**: 提供完整的执行日志和状态反馈

## 注意事项

1. **执行时间**: 串行执行会增加总体执行时间，特别是账号较多时
2. **自动合并**: 确保账号配置中启用了`auto_merge`以实现完整流程
3. **网络稳定**: 长时间执行需要稳定的网络连接
4. **错误处理**: 单个账号失败不会影响其他账号的处理

## 监控和日志

系统会提供详细的执行日志：
- 每个账号的开始和完成状态
- 提交和合并的详细信息
- 延迟和等待时间
- 错误和重试信息
- 最终的成功/失败统计

通过这种串行执行模式，可以有效避免多账号同时提交时的冲突问题，确保每个账号都能成功完成提交和合并流程。