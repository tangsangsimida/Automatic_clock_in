# ✨ 功能特性

- 🕒 **定时提交**: 每天自动在指定时间提交代码
- 👥 **多账号支持**: 同时管理多个GitHub账号的自动提交
- 🔄 **自动PR**: 自动创建Pull Request保持活跃
- 🤖 **自动合并**: 创建PR后自动合并到主分支，无需手动操作
- 🗑️ **智能清理**: 合并后自动删除临时分支，保持仓库整洁
- 📁 **文件隔离**: 每个用户的提交文件放在独立文件夹，避免冲突
- 📊 **智能内容**: 生成随机的提交内容和技术栈信息
- ⚙️ **灵活配置**: 支持自定义提交时间和频率
- 📅 **多种频率**: 支持每日、频繁、每小时、最少、自定义等提交模式
- 🛠️ **多种部署**: 支持systemd服务和crontab定时任务
- 📝 **详细日志**: 完整的操作日志记录，每个账号独立日志
- 🎮 **交互模式**: 支持命令行交互操作
- 🔄 **串行执行**: 多账号依次提交并合并，避免冲突
- 🔥 **配置热重载**: 修改配置后无需重启服务，自动检测并应用新配置
- 🛡️ **冲突避免**: 智能串行处理，确保每个账号完成完整流程

## 🤖 自动合并功能详解

### 🎯 功能概述

自动合并功能是本系统的核心特性之一，它能够在创建Pull Request后自动完成合并操作，无需手动干预，让您的GitHub贡献图保持持续活跃。

### ✨ 主要特性

#### 🔄 自动PR合并
- **智能合并**: 创建PR后自动检测并合并到主分支
- **安全可靠**: 只合并系统自动创建的PR，不影响其他手动PR
- **状态监控**: 实时监控PR状态，确保合并成功

#### 🗑️ 智能分支清理
- **自动删除**: 合并成功后自动删除临时分支
- **保持整洁**: 避免仓库中积累大量无用分支
- **可配置**: 支持选择是否启用分支删除功能

#### 📁 用户文件隔离
- **独立目录**: 每个用户的提交文件存放在 `users/{username}/daily_commits/` 目录下
- **避免冲突**: 多用户同时使用时不会产生文件冲突
- **清晰管理**: 便于区分和管理不同用户的提交内容

### ⚙️ 配置选项

在账号配置中，您可以通过以下选项控制自动合并行为：

```json
{
  "auto_merge": true,                    // 是否启用自动合并（默认：true）
  "delete_branch_after_merge": true      // 合并后是否删除分支（默认：true）
}
```

#### 配置说明

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `auto_merge` | boolean | `true` | 控制是否在创建PR后自动合并 |
| `delete_branch_after_merge` | boolean | `true` | 控制合并成功后是否删除临时分支 |

### 🔧 使用场景

#### 场景1：完全自动化（推荐）
```json
{
  "auto_merge": true,
  "delete_branch_after_merge": true
}
```
- ✅ 创建PR → 自动合并 → 自动删除分支
- ✅ 完全无人值守，保持仓库整洁
- ✅ 适合个人项目和自动化场景

#### 场景2：仅自动合并
```json
{
  "auto_merge": true,
  "delete_branch_after_merge": false
}
```
- ✅ 创建PR → 自动合并
- ❌ 保留分支（需要手动清理）
- 🎯 适合需要保留分支历史的场景

#### 场景3：手动控制
```json
{
  "auto_merge": false,
  "delete_branch_after_merge": false
}
```
- ✅ 仅创建PR，不自动合并
- 🎯 适合需要代码审查的团队项目
- 🎯 适合谨慎的生产环境

### 🛡️ 安全保障

- **权限验证**: 使用您的GitHub Token进行操作，确保安全性
- **错误处理**: 完善的异常处理机制，操作失败时不会影响系统稳定性
- **日志记录**: 详细记录每次操作，便于问题排查和审计
- **状态检查**: 合并前检查PR状态，确保操作的正确性

### 📊 工作流程

```
1. 📝 生成提交内容
   ↓
2. 🌿 创建新分支 (auto-commit-YYYYMMDD-HHMMSS)
   ↓
3. 📤 推送到远程仓库
   ↓
4. 🔄 创建Pull Request
   ↓
5. 🤖 自动合并PR (如果启用)
   ↓
6. 🗑️ 删除临时分支 (如果启用)
   ↓
7. ✅ 完成，等待下次执行
```

### 💡 最佳实践

1. **个人项目**: 建议启用完全自动化模式
2. **团队项目**: 建议关闭自动合并，保留代码审查流程
3. **测试环境**: 可以启用自动合并，便于快速迭代
4. **生产环境**: 建议谨慎使用，根据团队规范决定

## 🔄 串行执行模式

### 🎯 功能概述

为了解决多账号同时提交时产生未合并PR和合并冲突的问题，系统采用串行执行模式。多个账号会依次进行提交和合并，确保每个账号完成完整的提交-合并流程后再处理下一个账号。

### ✨ 主要优势

#### 🛡️ 避免合并冲突
- **问题解决**: 彻底解决多账号并发提交时的合并冲突
- **稳定可靠**: 确保每个PR都能成功合并
- **无需干预**: 自动处理冲突检测和重试

#### 📋 完整流程保障
- **顺序执行**: 账号A完成 → 账号B开始 → 账号B完成 → 账号C开始
- **完整周期**: 提交 → 创建PR → 自动合并 → 删除分支 → 下一个账号
- **状态跟踪**: 实时监控每个账号的执行状态

#### ⏱️ 智能延迟机制
- **基础延迟**: 账号间30秒基础间隔（可配置）
- **递增延迟**: 后续账号额外增加15秒（可配置）
- **冲突重试**: 检测到冲突时智能等待和重试

### ⚙️ 配置说明

```json
{
  "serial_execution_delay": 30,        // 账号间基础延迟（秒）
  "serial_execution_increment": 15,    // 每个账号的额外延迟（秒）
  "max_workers": 1,                    // 确保串行执行
  "enable_smart_retry": true           // 启用智能重试
}
```

### 📊 执行时序示例

假设有3个账号（A、B、C），执行流程：

```
时间轴:
00:00 - 🚀 开始处理账号A
00:30 - ✅ 账号A完成，开始处理账号B（延迟30s）
01:15 - ✅ 账号B完成，开始处理账号C（延迟45s）
02:15 - ✅ 账号C完成，所有账号处理完毕
```

### 📝 详细日志

系统提供完整的执行日志：
- 每个账号的开始和完成状态
- 提交和合并的详细信息
- 延迟和等待时间记录
- 错误和重试详情
- 最终成功/失败统计